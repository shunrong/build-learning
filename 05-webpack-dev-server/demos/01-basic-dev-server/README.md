# Demo 1: Webpack Dev Server åŸºç¡€é…ç½®

## ğŸ“– å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬ Demoï¼Œä½ å°†æŒæ¡ï¼š

1. âœ… **åŸºç¡€é…ç½®**ï¼športã€openã€hot ç­‰æ ¸å¿ƒé€‰é¡¹
2. âœ… **é™æ€æ–‡ä»¶æœåŠ¡**ï¼šå¦‚ä½•é…ç½® static æä¾›é™æ€èµ„æº
3. âœ… **å¼€å‘ä½“éªŒä¼˜åŒ–**ï¼šå‹ç¼©ã€æ—¥å¿—ã€è¿›åº¦æ˜¾ç¤º
4. âœ… **å®¢æˆ·ç«¯é…ç½®**ï¼šé”™è¯¯è¦†ç›–å±‚ã€æ—¥å¿—çº§åˆ«
5. âœ… **å¼€å‘ä¸­é—´ä»¶**ï¼šè¾“å‡ºæ§åˆ¶ã€ç£ç›˜å†™å…¥

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æœåŠ¡å™¨å°†è‡ªåŠ¨ï¼š
- ğŸ” å¯»æ‰¾å¯ç”¨ç«¯å£
- ğŸŒ æ‰“å¼€æµè§ˆå™¨
- ğŸ”¥ å¯ç”¨çƒ­æ¨¡å—æ›¿æ¢
- ğŸ“Š æ˜¾ç¤ºç¼–è¯‘è¿›åº¦

### 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
01-basic-dev-server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.html          # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ index.js            # å…¥å£ JS
â”‚   â””â”€â”€ styles.css          # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ public/
â”‚   â””â”€â”€ data.json           # é™æ€æ–‡ä»¶ç¤ºä¾‹
â”œâ”€â”€ webpack.config.js       # Webpack é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## ğŸ¯ æ ¸å¿ƒé…ç½®è¯¦è§£

### 1. åŸºç¡€é…ç½®

```javascript
devServer: {
  port: 'auto',              // è‡ªåŠ¨å¯»æ‰¾å¯ç”¨ç«¯å£
  open: true,                // è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
  hot: true,                 // å¯ç”¨ HMR
}
```

**é…ç½®è¯´æ˜**ï¼š
- `port: 'auto'`ï¼šé¿å…ç«¯å£å†²çªï¼Œè‡ªåŠ¨é€‰æ‹©å¯ç”¨ç«¯å£
- `open: true`ï¼šå¯åŠ¨åè‡ªåŠ¨åœ¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€
- `hot: true`ï¼šå¯ç”¨ HMRï¼ŒCSS å¯ä»¥æ— åˆ·æ–°æ›´æ–°

### 2. é™æ€æ–‡ä»¶æœåŠ¡

```javascript
static: {
  directory: path.join(__dirname, 'public'),
  publicPath: '/static',     // è®¿é—®è·¯å¾„
  watch: true                // ç›‘å¬æ–‡ä»¶å˜åŒ–
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ”¾ç½®ä¸éœ€è¦ webpack å¤„ç†çš„æ–‡ä»¶
- å¦‚ï¼šmock æ•°æ®ã€å›¾ç‰‡ã€å­—ä½“ç­‰
- è®¿é—®æ–¹å¼ï¼š`http://localhost:port/static/data.json`

### 3. å®¢æˆ·ç«¯é…ç½®

```javascript
client: {
  logging: 'info',           // æ—¥å¿—çº§åˆ«
  overlay: {
    errors: true,            // æ˜¾ç¤ºé”™è¯¯è¦†ç›–å±‚
    warnings: false          // ä¸æ˜¾ç¤ºè­¦å‘Š
  },
  progress: true             // æ˜¾ç¤ºç¼–è¯‘è¿›åº¦
}
```

**æ—¥å¿—çº§åˆ«**ï¼š
- `none`ï¼šæ— æ—¥å¿—
- `error`ï¼šä»…é”™è¯¯
- `warn`ï¼šé”™è¯¯å’Œè­¦å‘Š
- `info`ï¼šä¿¡æ¯ã€è­¦å‘Šã€é”™è¯¯
- `log`ï¼šæ›´è¯¦ç»†çš„æ—¥å¿—
- `verbose`ï¼šæœ€è¯¦ç»†

### 4. å¼€å‘ä¸­é—´ä»¶

```javascript
devMiddleware: {
  writeToDisk: false,        // ä¸å†™å…¥ç£ç›˜ï¼ˆå†…å­˜ä¸­ï¼‰
  stats: 'minimal'           // è¾“å‡ºç»Ÿè®¡ä¿¡æ¯
}
```

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- `writeToDisk: false`ï¼šæ–‡ä»¶å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé€Ÿåº¦æ›´å¿«
- `stats: 'minimal'`ï¼šå‡å°‘æ§åˆ¶å°è¾“å‡º

---

## ğŸ”¬ å®éªŒæŒ‡å—

### å®éªŒ 1ï¼šCSS çƒ­æ›´æ–°

**ç›®æ ‡**ï¼šä½“éªŒ CSS æ— åˆ·æ–°æ›´æ–°

1. å¯åŠ¨ `npm run dev`
2. ä¿®æ”¹ `src/styles.css` ä¸­çš„é¢œè‰²å€¼
3. è§‚å¯Ÿé¡µé¢æ ·å¼å®æ—¶æ›´æ–°ï¼Œ**æ— éœ€åˆ·æ–°**

```css
/* ä¿®æ”¹å½©è‰²æ–¹å—çš„é¢œè‰² */
.color-box {
  background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
}
```

**åŸç†**ï¼š
- `style-loader` æ”¯æŒ HMR
- CSS ä¿®æ”¹åï¼Œåªæ›¿æ¢æ ·å¼è¡¨
- ä¸éœ€è¦åˆ·æ–°é¡µé¢

---

### å®éªŒ 2ï¼šJavaScript æ›´æ–°

**ç›®æ ‡**ï¼šè§‚å¯Ÿ JS æ›´æ–°è¡Œä¸º

1. ä¿®æ”¹ `src/index.js` ä¸­çš„ä»£ç 
2. è§‚å¯Ÿé¡µé¢**è‡ªåŠ¨åˆ·æ–°**

```javascript
// ä¿®æ”¹åˆå§‹è®¡æ•°å€¼
let count = 100;
```

**ä¸ºä»€ä¹ˆåˆ·æ–°**ï¼š
- JS ä¿®æ”¹é€šå¸¸éœ€è¦é‡æ–°åˆå§‹åŒ–
- é™¤éå®ç°äº† `module.hot.accept()`
- ä¸‹ä¸€ä¸ª Demo ä¼šæ¼”ç¤º JS çš„ HMR

---

### å®éªŒ 3ï¼šé”™è¯¯è¦†ç›–å±‚

**ç›®æ ‡**ï¼šä½“éªŒé”™è¯¯æç¤ºåŠŸèƒ½

1. åˆ¶é€ è¯­æ³•é”™è¯¯

```javascript
// åœ¨ index.js ä¸­æ•…æ„å†™é”™
const test = 
```

2. è§‚å¯Ÿæµè§ˆå™¨ä¸­çš„é”™è¯¯è¦†ç›–å±‚
3. ä¿®å¤é”™è¯¯ï¼Œè¦†ç›–å±‚è‡ªåŠ¨æ¶ˆå¤±

**é…ç½®**ï¼š
```javascript
client: {
  overlay: {
    errors: true,           // âœ… æ˜¾ç¤ºé”™è¯¯
    warnings: false         // âŒ ä¸æ˜¾ç¤ºè­¦å‘Š
  }
}
```

---

### å®éªŒ 4ï¼šé™æ€æ–‡ä»¶æœåŠ¡

**ç›®æ ‡**ï¼šæµ‹è¯•é™æ€èµ„æºè®¿é—®

1. ç‚¹å‡»"åŠ è½½é™æ€æ–‡ä»¶"æŒ‰é’®
2. æŸ¥çœ‹åŠ è½½çš„ JSON æ•°æ®
3. ä¿®æ”¹ `public/data.json`
4. å†æ¬¡ç‚¹å‡»æŒ‰é’®ï¼ŒæŸ¥çœ‹æ›´æ–°

**è®¿é—®è·¯å¾„**ï¼š
- é…ç½®çš„ `publicPath: '/static'`
- è®¿é—® URLï¼š`/static/data.json`
- å®é™…æ–‡ä»¶ï¼š`public/data.json`

---

### å®éªŒ 5ï¼šä¿®æ”¹é…ç½®

**ç›®æ ‡**ï¼šç†è§£ä¸åŒé…ç½®é¡¹çš„ä½œç”¨

å°è¯•ä¿®æ”¹ `webpack.config.js`ï¼š

```javascript
devServer: {
  port: 8080,              // å›ºå®šç«¯å£
  open: false,             // ä¸è‡ªåŠ¨æ‰“å¼€
  hot: false,              // ç¦ç”¨ HMR
  
  client: {
    logging: 'verbose',    // æ›´è¯¦ç»†çš„æ—¥å¿—
    overlay: {
      warnings: true       // æ˜¾ç¤ºè­¦å‘Š
    }
  }
}
```

è§‚å¯Ÿæ¯ä¸ªé…ç½®çš„æ•ˆæœã€‚

---

## ğŸ’¡ é…ç½®æœ€ä½³å®è·µ

### å¼€å‘ç¯å¢ƒæ¨èé…ç½®

```javascript
devServer: {
  port: 'auto',
  open: true,
  hot: true,
  compress: true,
  
  client: {
    logging: 'info',
    overlay: {
      errors: true,
      warnings: false      // ç”Ÿäº§ç¯å¢ƒå†å…³æ³¨è­¦å‘Š
    },
    progress: true
  },
  
  devMiddleware: {
    writeToDisk: false,    // å†…å­˜æ¨¡å¼æ›´å¿«
    stats: 'minimal'       // å‡å°‘è¾“å‡º
  }
}
```

### ç”Ÿäº§ç¯å¢ƒ

ç”Ÿäº§ç¯å¢ƒä¸ä½¿ç”¨ dev serverï¼Œä½†å¯ä»¥å‚è€ƒï¼š

```javascript
// ç”Ÿäº§æ„å»ºä¸éœ€è¦ devServer
// ä½†å¯ä»¥ç”¨ webpack-dev-middleware åœ¨ Node.js ä¸­ä½¿ç”¨
```

---

## ğŸ“ çŸ¥è¯†ç‚¹æ€»ç»“

### 1. Dev Server çš„ä½œç”¨

- âœ… æä¾›æœ¬åœ°å¼€å‘æœåŠ¡å™¨
- âœ… å®ç°æ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰
- âœ… è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨
- âœ… æä¾›é™æ€æ–‡ä»¶æœåŠ¡
- âœ… ä»£ç† API è¯·æ±‚ï¼ˆä¸‹ä¸ª Demo æ¼”ç¤ºï¼‰

### 2. HMR vs è‡ªåŠ¨åˆ·æ–°

| ç‰¹æ€§ | HMR | è‡ªåŠ¨åˆ·æ–° |
|------|-----|----------|
| **CSS** | âœ… æ— åˆ·æ–°æ›´æ–° | âŒ åˆ·æ–°é¡µé¢ |
| **JS** | éœ€è¦é¢å¤–é…ç½® | âœ… è‡ªåŠ¨åˆ·æ–° |
| **çŠ¶æ€ä¿æŒ** | âœ… ä¿æŒçŠ¶æ€ | âŒ ä¸¢å¤±çŠ¶æ€ |
| **é€Ÿåº¦** | âš¡ æ›´å¿« | ğŸ¢ è¾ƒæ…¢ |

### 3. é™æ€æ–‡ä»¶ vs Webpack æ¨¡å—

| ç±»å‹ | é™æ€æ–‡ä»¶ | Webpack æ¨¡å— |
|------|----------|--------------|
| **å¤„ç†æ–¹å¼** | ç›´æ¥è®¿é—® | ç»è¿‡ loader å¤„ç† |
| **è·¯å¾„** | `/static/xxx` | `import xxx` |
| **ç”¨é€”** | Mock æ•°æ®ã€èµ„æº | æºä»£ç ã€ä¾èµ– |
| **å˜åŒ–** | éœ€è¦åˆ·æ–° | HMR æ›´æ–° |

### 4. é…ç½®ä¼˜å…ˆçº§

```javascript
// é…ç½®å±‚æ¬¡
devServer: {
  // 1. åŸºç¡€é…ç½®ï¼ˆå¿…é¡»ï¼‰
  port, open, hot
  
  // 2. é™æ€æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
  static
  
  // 3. å®¢æˆ·ç«¯é…ç½®ï¼ˆä¼˜åŒ–ä½“éªŒï¼‰
  client
  
  // 4. ä¸­é—´ä»¶é…ç½®ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
  devMiddleware
  
  // 5. é«˜çº§é…ç½®ï¼ˆä¸‹ä¸ª Demoï¼‰
  proxy, historyApiFallback
}
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [webpack-dev-server å®˜æ–¹æ–‡æ¡£](https://webpack.js.org/configuration/dev-server/)
- [HMR æŒ‡å—](https://webpack.js.org/guides/hot-module-replacement/)
- æœ¬é¡¹ç›®æ–‡æ¡£ï¼š`../docs/01-dev-server-basics.md`

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

**é—®é¢˜**ï¼š`EADDRINUSE: address already in use :::3000`

**è§£å†³**ï¼š
```javascript
devServer: {
  port: 'auto'  // è‡ªåŠ¨å¯»æ‰¾å¯ç”¨ç«¯å£
}
```

### 2. é™æ€æ–‡ä»¶ 404

**é—®é¢˜**ï¼š`/static/data.json` è¿”å› 404

**æ£€æŸ¥**ï¼š
1. `public` ç›®å½•æ˜¯å¦å­˜åœ¨
2. `publicPath` é…ç½®æ˜¯å¦æ­£ç¡®
3. è®¿é—®è·¯å¾„æ˜¯å¦æ­£ç¡®

### 3. HMR ä¸å·¥ä½œ

**åŸå› **ï¼š
- `hot: false` æœªå¯ç”¨
- ä½¿ç”¨äº† `[contenthash]`ï¼ˆå¼€å‘ç¯å¢ƒä¸éœ€è¦ï¼‰
- æµè§ˆå™¨ç¼“å­˜é—®é¢˜

**è§£å†³**ï¼š
```javascript
devServer: {
  hot: true
}
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å®Œæˆæœ¬ Demo åï¼Œç»§ç»­å­¦ä¹ ï¼š

- **Demo 2**ï¼šHMR æ·±å…¥æ¼”ç¤ºï¼ˆJSã€React HMRï¼‰
- **Demo 3**ï¼šä»£ç†é…ç½®ï¼ˆè§£å†³è·¨åŸŸï¼‰
- **Demo 4**ï¼šå¤šé¡µé¢åº”ç”¨é…ç½®

æŒæ¡è¿™äº›åŸºç¡€åï¼Œä½ å°†èƒ½å¤Ÿæ„å»ºé«˜æ•ˆçš„å¼€å‘ç¯å¢ƒï¼ğŸš€

