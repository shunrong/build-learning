# Oxc Parser

## ğŸ“– æ¦‚è¿°

Oxcï¼ˆOxidation Compilerï¼‰æ˜¯**æ–°ä¸€ä»£ Rust å·¥å…·é“¾**ï¼Œç›®æ ‡æ˜¯ç»Ÿä¸€å‰ç«¯å·¥å…·é“¾ï¼Œæ€§èƒ½æ¯” SWC è¿˜å¿« **2-3 å€**ã€‚

---

## ğŸš€ Oxc çš„åˆ›æ–°

### 1. æ›´æè‡´çš„æ€§èƒ½

**æ€§èƒ½æ•°æ®ï¼ˆ100 KB ä»£ç ï¼‰ï¼š**
```
Babel Parser:    100-150 MB/s
SWC Parser:      1500-2000 MB/s  (10-15x Babel)
Oxc Parser:      3000-5000 MB/s  (30-50x Babel, 2-3x SWC!)
```

**çœŸå®é¡¹ç›®æµ‹è¯•ï¼ˆReact æºç  ~500 KBï¼‰ï¼š**
```
Babel:  500ms
SWC:    33ms   (15x æ›´å¿«)
Oxc:    12ms   (42x æ›´å¿«ï¼Œ2.7x SWC!)
```

### 2. ä¸ºä»€ä¹ˆ Oxc æ¯” SWC è¿˜å¿«ï¼Ÿ

**æ ¸å¿ƒä¼˜åŒ–ï¼š**

#### a. æ›´æ¿€è¿›çš„å†…å­˜ä¼˜åŒ–
```rust
// SWC: ä½¿ç”¨æ ‡å‡†çš„ Rc/Arc
let node = Rc::new(AstNode::new());

// Oxc: ä½¿ç”¨è‡ªå®šä¹‰çš„ Arena åˆ†é…å™¨
let node = arena.alloc(AstNode::new());
// â†’ å‡å°‘åˆ†é…å¼€é”€ï¼Œæå‡ç¼“å­˜å‘½ä¸­ç‡
```

#### b. æ›´å¥½çš„æ•°æ®ç»“æ„
```rust
// Oxc ä½¿ç”¨ç´§å‡‘çš„æ•°æ®ç»“æ„
pub struct CompactStr {
    // å°å­—ç¬¦ä¸²ç›´æ¥å†…è”ï¼Œå¤§å­—ç¬¦ä¸²ç”¨æŒ‡é’ˆ
    // å‡å°‘å †åˆ†é…
}
```

#### c. SIMD æ·±åº¦ä¼˜åŒ–
```rust
// Oxc åœ¨è¯æ³•åˆ†æä¸­å¤§é‡ä½¿ç”¨ SIMD
// ä¸€æ¬¡å¤„ç† 32 ä¸ªå­—ç¬¦
```

#### d. å‡å°‘ä¸å¿…è¦çš„å·¥ä½œ
```rust
// Oxc åœ¨ä¸éœ€è¦æ—¶è·³è¿‡æŸäº› AST èŠ‚ç‚¹çš„æ„å»º
// æ‡’åŠ è½½æŸäº›ä¿¡æ¯
```

---

## ğŸ¯ Oxc çš„æ„¿æ™¯ï¼šç»Ÿä¸€å·¥å…·é“¾

### 1. é—®é¢˜ï¼šå·¥å…·é“¾ç¢ç‰‡åŒ–

**å½“å‰çŠ¶æ€ï¼š**
```
Parser:    Babel Parser / SWC
Linter:    ESLint
Formatter: Prettier
Minifier:  Terser
Bundler:   Webpack / Rollup

â†’ æ¯ä¸ªå·¥å…·éƒ½è¦è§£æä»£ç 
â†’ é‡å¤å·¥ä½œï¼Œæ€§èƒ½æµªè´¹
```

### 2. Oxc çš„è§£å†³æ–¹æ¡ˆ

**ç»Ÿä¸€å·¥å…·é“¾ï¼š**
```
Oxc
â”œâ”€â”€ oxc_parser      (Parser)
â”œâ”€â”€ oxc_linter      (Linter, æ›¿ä»£ ESLint)
â”œâ”€â”€ oxc_formatter   (Formatter, æ›¿ä»£ Prettier)
â”œâ”€â”€ oxc_minifier    (Minifier, æ›¿ä»£ Terser)
â”œâ”€â”€ oxc_resolver    (Resolver)
â””â”€â”€ oxc_transformer (Transformer)

â†’ å…±äº«åŒä¸€ä¸ª AST
â†’ ä¸€æ¬¡è§£æï¼Œå¤šæ¬¡ä½¿ç”¨
â†’ æè‡´æ€§èƒ½
```

### 3. ä¸ Biome çš„å…³ç³»

**Biomeï¼š** å¦ä¸€ä¸ªç»Ÿä¸€å·¥å…·é“¾é¡¹ç›®ï¼ˆRustï¼‰

**å¯¹æ¯”ï¼š**
| ç‰¹æ€§ | Oxc | Biome |
|------|-----|-------|
| **è¯­è¨€** | Rust | Rust |
| **æ€§èƒ½** | æ›´å¿« | å¿« |
| **åŠŸèƒ½** | Parser + Linter + Formatter + ... | Linter + Formatter |
| **çŠ¶æ€** | å¿«é€Ÿå‘å±• | æˆç†Ÿ |
| **ç›®æ ‡** | ç»Ÿä¸€æ‰€æœ‰å·¥å…· | æ›¿ä»£ ESLint/Prettier |

---

## â­ Oxc Parser ç‰¹æ€§

### 1. ä½¿ç”¨ç¤ºä¾‹

```javascript
const oxc = require('oxc-parser');

const code = `const x: number = 1;`;
const ast = oxc.parseSync(code, {
  sourceType: 'module',
  sourceFilename: 'test.ts'
});

console.log(ast);
```

### 2. è¯­æ³•æ”¯æŒ

**å®Œæ•´æ”¯æŒï¼š**
- ES2024+ æ‰€æœ‰ç‰¹æ€§
- TypeScript
- JSX
- æ‰€æœ‰å®éªŒæ€§ç‰¹æ€§

### 3. é”™è¯¯æ¢å¤

**Oxc çš„åˆ›æ–°ï¼šæ›´å¥½çš„é”™è¯¯æ¢å¤**

```javascript
// ä»£ç æœ‰é”™è¯¯
const code = `
  const x = 1;
  const y = ;  // é”™è¯¯
  const z = 3;
`;

// Oxc ä»ç„¶èƒ½è§£æå¹¶ç”Ÿæˆ AST
const ast = oxc.parseSync(code, {
  allowReturnOutsideFunction: true
});

// è¿”å› AST + é”™è¯¯åˆ—è¡¨
console.log(ast.errors);
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”æ€»ç»“

### ç»¼åˆå¯¹æ¯”

| Parser | é€Ÿåº¦ | å†…å­˜ | åŒ…å¤§å° | ç»´æŠ¤ |
|--------|------|------|--------|------|
| **Babel** | 100 MB/s | 40 MB | 2 MB | âœ… |
| **Acorn** | 200 MB/s | 20 MB | 500 KB | âœ… |
| **SWC** | 1800 MB/s | 12 MB | 20 MB | âœ… |
| **Oxc** | 4500 MB/s | 8 MB | 15 MB | âš ï¸ |

### æ€§èƒ½æå‡æ±‡æ€»

```
Babel â†’ Acorn:  2x æå‡
Babel â†’ SWC:    15-20x æå‡
Babel â†’ Oxc:    40-50x æå‡
SWC â†’ Oxc:      2-3x æå‡
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### Oxc é€‚åˆ

**ç†æƒ³åœºæ™¯ï¼š**
- âœ… è¶…å¤§å‹é¡¹ç›®ï¼ˆç™¾ä¸‡è¡Œä»£ç ï¼‰
- âœ… Monorepoï¼ˆå¤šä¸ªåŒ…å…±äº«å·¥å…·é“¾ï¼‰
- âœ… CI/CDï¼ˆæè‡´çš„æ„å»ºé€Ÿåº¦ï¼‰
- âœ… å¼€å‘å·¥å…·ï¼ˆIDEã€Linterï¼‰

**æˆåŠŸæ¡ˆä¾‹ï¼š**
- Shopifyï¼ˆæ­£åœ¨è¿ç§»ï¼‰
- Discordï¼ˆæ­£åœ¨è¯„ä¼°ï¼‰

### é™åˆ¶

**å½“å‰é™åˆ¶ï¼š**
- âš ï¸ ä»åœ¨å¿«é€Ÿå‘å±•ï¼ˆAPI å¯èƒ½å˜åŒ–ï¼‰
- âš ï¸ ç”Ÿæ€ç³»ç»Ÿè¾ƒæ–°
- âš ï¸ æ–‡æ¡£è¿˜åœ¨å®Œå–„ä¸­

---

## ğŸ”® æœªæ¥è¶‹åŠ¿

### 1. å·¥å…·é“¾ç»Ÿä¸€

**è¶‹åŠ¿ï¼š**
```
è¿‡å»ï¼š
Parser (Babel) + Linter (ESLint) + Formatter (Prettier) + ...
â†’ æ…¢ï¼Œé‡å¤å·¥ä½œ

æœªæ¥ï¼š
Oxc æˆ– Biome ç»Ÿä¸€å·¥å…·é“¾
â†’ å¿«ï¼Œä¸€æ¬¡è§£æ
```

### 2. Rust æˆä¸ºæ ‡å‡†

**è¶‹åŠ¿ï¼š**
- SWCã€Oxcã€Biome éƒ½ç”¨ Rust
- Turbopackã€Rspack ç”¨ Rust
- Deno ç”¨ Rust

**åŸå› ï¼š**
- 10-100x æ€§èƒ½æå‡
- æ›´å¥½çš„å†…å­˜ç®¡ç†
- å¤šæ ¸å¹¶è¡Œ

### 3. JavaScript å·¥å…·é“¾çš„ç»ˆå±€

**å¯èƒ½çš„ç»“å±€ï¼š**
```
Oxc / Biome ç»Ÿä¸€å·¥å…·é“¾
â†“
æ‰€æœ‰å·¥å…·éƒ½åŸºäºæ­¤
â†“
å‰ç«¯å¼€å‘ä½“éªŒè´¨çš„é£è·ƒ
```

---

## ğŸ“ å…³é”®è¦ç‚¹

1. **æè‡´æ€§èƒ½**ï¼š40-50x Babelï¼Œ2-3x SWC
2. **ç»Ÿä¸€å·¥å…·é“¾**ï¼šä¸€æ¬¡è§£æï¼Œå¤šæ¬¡ä½¿ç”¨
3. **Rust ä¼˜åŠ¿**ï¼šArena åˆ†é…å™¨ã€SIMDã€é›¶æˆæœ¬æŠ½è±¡
4. **æœªæ¥è¶‹åŠ¿**ï¼šå·¥å…·é“¾ç»Ÿä¸€ã€Rust æˆä¸ºæ ‡å‡†
5. **å¿«é€Ÿå‘å±•**ï¼šä»åœ¨å®Œå–„ä¸­

---

## ğŸ”— ä¸‹ä¸€æ­¥

- **05-parser-selection.md**ï¼šParser é€‰å‹æŒ‡å—
- **Demo 02**ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•

**è®°ä½ï¼šOxc ä»£è¡¨ç€å‰ç«¯å·¥å…·é“¾çš„æœªæ¥ï¼** ğŸ‰

