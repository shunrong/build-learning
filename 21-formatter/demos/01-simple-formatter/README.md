# 01 - ç®€å•ä»£ç æ ¼å¼åŒ–å™¨

## ğŸ“‹ é¡¹ç›®è¯´æ˜

è¿™ä¸ª Demo å±•ç¤ºäº†ä»£ç æ ¼å¼åŒ–å™¨ï¼ˆFormatterï¼‰çš„æ ¸å¿ƒåŸç†ï¼šä» AST ç”Ÿæˆæ ¼å¼åŒ–åçš„ä»£ç ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

1. ç†è§£ **AST â†’ æ ¼å¼åŒ–ä»£ç ** çš„æµç¨‹
2. æŒæ¡é€’å½’æ‰“å° AST èŠ‚ç‚¹çš„æ–¹æ³•
3. å­¦ä¼šåº”ç”¨æ ¼å¼åŒ–è§„åˆ™ï¼ˆç¼©è¿›ã€ç©ºæ ¼ã€åˆ†å·ï¼‰
4. ç†è§£æ ¼å¼åŒ–ä¸æ”¹å˜ä»£ç è¯­ä¹‰çš„åŸåˆ™

## ğŸš€ è¿è¡Œæ–¹å¼

```bash
npm install
npm start
```

## ğŸ“Š æ¼”ç¤ºå†…å®¹

### æµ‹è¯• 1ï¼šå˜é‡å£°æ˜
```javascript
// æ ¼å¼åŒ–å‰
const x=1;const y=2

// æ ¼å¼åŒ–å
const x = 1;
const y = 2;
```

### æµ‹è¯• 2ï¼šå‡½æ•°å£°æ˜
```javascript
// æ ¼å¼åŒ–å‰
function add(a,b){return a+b}

// æ ¼å¼åŒ–å
function add(a, b) {
  return a + b;
}
```

### æµ‹è¯• 3ï¼šå¤æ‚è¡¨è¾¾å¼
```javascript
// æ ¼å¼åŒ–å‰
const sum=arr.filter(x=>x>0).reduce((a,b)=>a+b,0)

// æ ¼å¼åŒ–å
const sum = arr.filter(x => x > 0).reduce((a, b) => a + b, 0);
```

### æµ‹è¯• 4ï¼šif è¯­å¥
```javascript
// æ ¼å¼åŒ–å‰
function test(x){if(x>0){console.log("positive")}else{console.log("negative")}}

// æ ¼å¼åŒ–å
function test(x) {
  if (x > 0) {
    console.log('positive');
  } else {
    console.log('negative');
  }
}
```

## ğŸ” æ ¸å¿ƒä»£ç è§£æ

### 1. ä¸»æµç¨‹

```javascript
class SimpleFormatter {
  format(code) {
    const ast = parser.parse(code);  // 1. è§£æ
    return this.printProgram(ast.program);  // 2. æ‰“å°
  }
}
```

### 2. é€’å½’æ‰“å°

```javascript
print(node) {
  switch (node.type) {
    case 'VariableDeclaration':
      return this.printVariableDeclaration(node);
    case 'FunctionDeclaration':
      return this.printFunctionDeclaration(node);
    // ... å¤„ç†å…¶ä»–ç±»å‹
  }
}
```

### 3. åº”ç”¨æ ¼å¼åŒ–è§„åˆ™

```javascript
// ç¼©è¿›
indent() {
  return this.config.indent.repeat(this.indentLevel);
}

// åˆ†å·
semi() {
  return this.config.semicolon ? ';' : '';
}

// ç©ºæ ¼
space() {
  return this.config.space ? ' ' : '';
}
```

## ğŸ’¡ æ ¸å¿ƒåŸç†

```
åŸå§‹ä»£ç 
  â†“
Parserï¼ˆ@babel/parserï¼‰
  â†“
AST
  â†“
é€’å½’éå†èŠ‚ç‚¹
  â†“
ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆä»£ç ç‰‡æ®µ
  â†“
åº”ç”¨æ ¼å¼åŒ–è§„åˆ™ï¼ˆç¼©è¿›ã€ç©ºæ ¼ã€åˆ†å·ï¼‰
  â†“
æ‹¼æ¥ä¸ºæœ€ç»ˆä»£ç 
```

## ğŸ¨ æ”¯æŒçš„è¯­æ³•

- âœ… å˜é‡å£°æ˜ï¼ˆconst/let/varï¼‰
- âœ… å‡½æ•°å£°æ˜
- âœ… è¡¨è¾¾å¼è¯­å¥
- âœ… è¿”å›è¯­å¥
- âœ… if/else è¯­å¥
- âœ… äºŒå…ƒè¡¨è¾¾å¼
- âœ… å‡½æ•°è°ƒç”¨
- âœ… ç®­å¤´å‡½æ•°
- âœ… æˆå‘˜è®¿é—®

## ğŸ“š ä¸ Prettier çš„å¯¹æ¯”

| ç‰¹æ€§ | æœ¬ Demo | Prettier |
|------|---------|----------|
| æ”¯æŒè¯­æ³• | åŸºç¡€è¯­æ³• | æ‰€æœ‰ JS è¯­æ³• |
| æ ¼å¼åŒ–è§„åˆ™ | ç®€å•è§„åˆ™ | å¤æ‚çš„ Layout Algorithm |
| æ€§èƒ½ | é€‚ä¸­ | é«˜åº¦ä¼˜åŒ– |
| æ³¨é‡Šå¤„ç† | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| æ–­è¡Œç­–ç•¥ | ç®€å• | æ™ºèƒ½æ–­è¡Œ |

## ğŸ”§ æ‰©å±•ç»ƒä¹ 

1. **æ·»åŠ æ›´å¤šè¯­æ³•æ”¯æŒ**
   - æ”¯æŒ class å£°æ˜
   - æ”¯æŒ for/while å¾ªç¯
   - æ”¯æŒ try/catch

2. **ä¼˜åŒ–æ ¼å¼åŒ–è§„åˆ™**
   - å®ç°æ™ºèƒ½æ–­è¡Œï¼ˆè¶…è¿‡è¡Œå®½è‡ªåŠ¨æ¢è¡Œï¼‰
   - æ”¯æŒå¯¹è±¡å’Œæ•°ç»„çš„å¤šè¡Œæ ¼å¼åŒ–
   - å¤„ç†æ³¨é‡Šçš„ä¿ç•™

3. **æ·»åŠ é…ç½®é€‰é¡¹**
   - æ”¯æŒ 4 ç©ºæ ¼ç¼©è¿›
   - æ”¯æŒåŒå¼•å·
   - æ”¯æŒä¸åŠ åˆ†å·

## âš ï¸ å±€é™æ€§

- ä¸æ”¯æŒæ³¨é‡Šï¼ˆä¼šä¸¢å¤±ï¼‰
- ä¸æ”¯æŒæ‰€æœ‰ ES6+ è¯­æ³•
- æ²¡æœ‰æ™ºèƒ½æ–­è¡Œ
- æ€§èƒ½æœªä¼˜åŒ–

## ğŸ¯ å…³é”®æ”¶è·

1. Formatter æœ¬è´¨æ˜¯ **AST â†’ Code** çš„è½¬æ¢
2. é€šè¿‡é€’å½’éå†å®ç°
3. æ ¼å¼åŒ–è§„åˆ™ä½œä¸ºè¾…åŠ©æ–¹æ³•åº”ç”¨
4. ä¸æ”¹å˜ä»£ç è¯­ä¹‰ï¼Œåªæ”¹å˜é£æ ¼

