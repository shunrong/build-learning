# Phase 21: Formatter å­¦ä¹ æŒ‡å—

## ğŸ¯ å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬é˜¶æ®µçš„å­¦ä¹ ï¼Œä½ å°†ï¼š

1. **ç†è§£ Formatter çš„æ ¸å¿ƒåŸç†**
   - ä»£ç æ ¼å¼åŒ–çš„å·¥ä½œæµç¨‹
   - AST çš„æ‰“å°ï¼ˆPrintingï¼‰æœºåˆ¶
   - æ ¼å¼åŒ–è§„åˆ™çš„è®¾è®¡åŸåˆ™

2. **æŒæ¡ Prettier çš„å®ç°åŸç†**
   - Prettier çš„æ¶æ„è®¾è®¡
   - æ ¼å¼åŒ–ç®—æ³•ï¼ˆLayout Algorithmï¼‰
   - æ–­è¡Œç­–ç•¥ï¼ˆLine Breakingï¼‰

3. **å­¦ä¼šè‡ªå®šä¹‰ Formatter**
   - ä»é›¶å®ç°ç®€å•çš„ Formatter
   - å¤„ç†å„ç§è¯­æ³•ç»“æ„
   - å®ç°æ ¼å¼åŒ–è§„åˆ™

4. **ç†è§£ä¸ Linter çš„åŒºåˆ«å’Œé…åˆ**
   - Formatter vs Linter çš„èŒè´£è¾¹ç•Œ
   - å¦‚ä½•é¿å…å†²çª
   - å·¥ä½œæµé›†æˆ

---

## ğŸ“š å­¦ä¹ è·¯å¾„

### ç¬¬ä¸€æ­¥ï¼šç†è§£ Formatter åŸºç¡€ï¼ˆ1-2å°æ—¶ï¼‰
- é˜…è¯» `01-formatter-basics.md`
- ç†è§£ä»£ç æ ¼å¼åŒ–çš„æœ¬è´¨
- äº†è§£ AST â†’ Code çš„è¿‡ç¨‹

### ç¬¬äºŒæ­¥ï¼šPrettier å·¥ä½œåŸç†ï¼ˆ2-3å°æ—¶ï¼‰
- é˜…è¯» `02-prettier-internals.md`
- ç†è§£ Prettier çš„æ¶æ„
- å­¦ä¹ æ ¼å¼åŒ–ç®—æ³•

### ç¬¬ä¸‰æ­¥ï¼šå®ç°ç®€å• Formatterï¼ˆ3-4å°æ—¶ï¼‰
- é˜…è¯» `03-simple-formatter.md`
- è¿è¡Œ Demo 01-03
- å°è¯•ä¿®æ”¹å’Œæ‰©å±•

### ç¬¬å››æ­¥ï¼šé«˜çº§æ ¼å¼åŒ–æŠ€æœ¯ï¼ˆ2-3å°æ—¶ï¼‰
- é˜…è¯» `04-advanced-formatting.md`
- äº†è§£æ–­è¡Œç­–ç•¥
- å­¦ä¹ æ³¨é‡Šå¤„ç†

### ç¬¬äº”æ­¥ï¼šå·¥å…·é›†æˆï¼ˆ1-2å°æ—¶ï¼‰
- é˜…è¯» `05-integration.md`
- ç†è§£ Formatter çš„æœ€ä½³å®è·µ
- å­¦ä¹ ä¸å…¶ä»–å·¥å…·çš„é…åˆ

---

## ğŸ“‚ æ–‡æ¡£åˆ—è¡¨

1. **01-formatter-basics.md** - Formatter åŸºç¡€æ¦‚å¿µ
2. **02-prettier-internals.md** - Prettier å·¥ä½œåŸç†
3. **03-simple-formatter.md** - å®ç°ç®€å• Formatter
4. **04-advanced-formatting.md** - é«˜çº§æ ¼å¼åŒ–æŠ€æœ¯
5. **05-integration.md** - å·¥å…·é›†æˆä¸æœ€ä½³å®è·µ

---

## ğŸ¨ Demo é¡¹ç›®åˆ—è¡¨

### Demo 01: ç®€å•ä»£ç æ‰“å°å™¨
```
demos/01-simple-printer/
  - ä» AST ç”Ÿæˆä»£ç 
  - åŸºç¡€çš„ç¼©è¿›å¤„ç†
  - ç®€å•çš„æ¢è¡Œé€»è¾‘
```

### Demo 02: åŸºç¡€ Formatter
```
demos/02-basic-formatter/
  - æ ¼å¼åŒ–å˜é‡å£°æ˜
  - æ ¼å¼åŒ–å‡½æ•°å£°æ˜
  - å¤„ç†æ“ä½œç¬¦ç©ºæ ¼
```

### Demo 03: å®Œæ•´ Formatter
```
demos/03-complete-formatter/
  - æ”¯æŒå¤šç§è¯­æ³•ç»“æ„
  - å®ç°æ–­è¡Œç­–ç•¥
  - å¤„ç†æ³¨é‡Šå’Œç©ºè¡Œ
```

### Demo 04: Prettier è¿·ä½ ç‰ˆ
```
demos/04-prettier-mini/
  - æ¨¡æ‹Ÿ Prettier çš„æ ¸å¿ƒç®—æ³•
  - å®ç° Layout Algorithm
  - å¤„ç†åµŒå¥—ç»“æ„
```

### Demo 05: Formatter æ€§èƒ½å¯¹æ¯”
```
demos/05-formatter-benchmark/
  - å¯¹æ¯”ä¸åŒå®ç°çš„æ€§èƒ½
  - æµ‹è¯•å¤§æ–‡ä»¶æ ¼å¼åŒ–
  - åˆ†ææ€§èƒ½ç“¶é¢ˆ
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### ç†è®ºå±‚é¢
- [ ] èƒ½è§£é‡Š Formatter çš„å·¥ä½œåŸç†
- [ ] èƒ½è¯´å‡º AST Printing çš„æ ¸å¿ƒæ­¥éª¤
- [ ] èƒ½è§£é‡Š Prettier çš„æ ¼å¼åŒ–ç®—æ³•
- [ ] èƒ½å¯¹æ¯” Formatter å’Œ Linter çš„åŒºåˆ«

### å®è·µå±‚é¢
- [ ] èƒ½å®ç°ä¸€ä¸ªç®€å•çš„ Formatter
- [ ] èƒ½å¤„ç†åŸºæœ¬çš„è¯­æ³•ç»“æ„æ ¼å¼åŒ–
- [ ] èƒ½å®ç°ç¼©è¿›å’Œæ¢è¡Œé€»è¾‘
- [ ] èƒ½å¤„ç†æ³¨é‡Šçš„ä¿ç•™å’Œæ ¼å¼åŒ–

### é¢è¯•å±‚é¢
- [ ] èƒ½å›ç­”ï¼šFormatter å¦‚ä½•å·¥ä½œï¼Ÿ
- [ ] èƒ½å›ç­”ï¼šä¸ºä»€ä¹ˆéœ€è¦ Formatterï¼Ÿ
- [ ] èƒ½å›ç­”ï¼šPrettier çš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ
- [ ] èƒ½å›ç­”ï¼šå¦‚ä½•å®ç°è‡ªå®šä¹‰æ ¼å¼åŒ–è§„åˆ™ï¼Ÿ

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### 1. Code Printing
```
AST â†’ Tokens â†’ Formatted Code

æ ¸å¿ƒæ­¥éª¤ï¼š
1. éå† AST èŠ‚ç‚¹
2. ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆä»£ç ç‰‡æ®µ
3. åº”ç”¨æ ¼å¼åŒ–è§„åˆ™ï¼ˆç¼©è¿›ã€ç©ºæ ¼ã€æ¢è¡Œï¼‰
4. æ‹¼æ¥æˆæœ€ç»ˆä»£ç 
```

### 2. Layout Algorithm
```
Prettier çš„æ ¸å¿ƒç®—æ³•ï¼š

1. è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„æ‰“å°å®½åº¦
2. å¦‚æœè¶…è¿‡è¡Œå®½é™åˆ¶ â†’ æ¢è¡Œ
3. å¦‚æœæœªè¶…è¿‡ â†’ ä¿æŒå•è¡Œ
4. é€’å½’å¤„ç†å­èŠ‚ç‚¹
```

### 3. æ ¼å¼åŒ–è§„åˆ™
```
å¸¸è§çš„æ ¼å¼åŒ–è§„åˆ™ï¼š

- ç¼©è¿›ï¼š2 ç©ºæ ¼ / 4 ç©ºæ ¼ / Tab
- å¼•å·ï¼šå•å¼•å· / åŒå¼•å·
- åˆ†å·ï¼šåŠ åˆ†å· / ä¸åŠ åˆ†å·
- å°¾é€—å·ï¼šåŠ  / ä¸åŠ 
- è¡Œå®½ï¼š80 / 100 / 120 å­—ç¬¦
- æ¢è¡Œï¼šLF / CRLF
```

---

## ğŸ’¡ å­¦ä¹ å»ºè®®

1. **å¯¹æ¯”å­¦ä¹ **ï¼š
   - å¯¹æ¯” Formatter å’Œ Linter çš„åŒºåˆ«
   - å¯¹æ¯”ä¸åŒ Formatter çš„å®ç°æ–¹å¼
   - å¯¹æ¯”æ ¼å¼åŒ–å‰åçš„ä»£ç 

2. **å®è·µä¸ºä¸»**ï¼š
   - å…ˆè¿è¡Œ Demoï¼Œè§‚å¯Ÿæ•ˆæœ
   - ä¿®æ”¹æ ¼å¼åŒ–è§„åˆ™ï¼Œçœ‹çœ‹å˜åŒ–
   - å°è¯•æ·»åŠ æ–°çš„è¯­æ³•æ”¯æŒ

3. **é˜…è¯»æºç **ï¼š
   - é˜…è¯» Prettier çš„æ ¸å¿ƒæºç 
   - ç†è§£æ ¼å¼åŒ–ç®—æ³•çš„å®ç°
   - å­¦ä¹ ä¼˜ç§€çš„ä»£ç ç»“æ„

4. **å…³æ³¨ç»†èŠ‚**ï¼š
   - æ³¨é‡Šçš„å¤„ç†æ–¹å¼
   - ç©ºè¡Œçš„ä¿ç•™ç­–ç•¥
   - åµŒå¥—ç»“æ„çš„ç¼©è¿›

---

## ğŸ“– æ‰©å±•é˜…è¯»

1. [Prettier å®˜æ–¹æ–‡æ¡£](https://prettier.io/docs/en/index.html)
2. [Prettier çš„è®¾è®¡ç†å¿µ](https://prettier.io/docs/en/rationale.html)
3. [å¦‚ä½•ç¼–å†™ä¸€ä¸ªä»£ç æ ¼å¼åŒ–å™¨](https://journal.stuffwithstuff.com/2015/09/08/the-hardest-program-ive-ever-written/)
4. [AST-based Code Formatting](https://hackernoon.com/how-to-build-a-code-formatter-from-scratch)
5. [Prettier's Layout Algorithm](https://github.com/prettier/prettier/blob/main/commands.md)

---

## ğŸš€ å¼€å§‹å­¦ä¹ 

å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä» `01-formatter-basics.md` å¼€å§‹ï¼Œæ·±å…¥ç†è§£ä»£ç æ ¼å¼åŒ–çš„åŸç†ï¼

è®°ä½ï¼š**Formatter çš„ç›®æ ‡æ˜¯è®©ä»£ç ç¾è§‚ç»Ÿä¸€ï¼Œè€Œä¸æ”¹å˜ä»£ç çš„è¯­ä¹‰**ã€‚

